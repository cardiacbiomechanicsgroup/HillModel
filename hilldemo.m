% hilldemo.m% Demonstrates use of function hill for solving hill model for prescribed length inputs.% Execute one section at a time by copying/pasting into command window.% EXAMPLE 1 - ISOMETRIC TETANUSL = [repmat(1,1000,1)];t = [linspace(0,5,1000)'];[P,H,Lse,Lce] = hill(L,t);figure(1)subplot(2,2,1); plot(t,L,'k'); axis([0 5 0 2]); xlabel('Time (sec)'); ylabel('Length/L0');subplot(2,2,2); plot(t,P,'r'); axis([0 5 0 200]); xlabel('Time (sec)'); ylabel('Force (mN/mm2)');subplot(2,2,3); plot(t,Lse,'g'); axis([0 5 0 1]);xlabel('Time (sec)'); ylabel('Lseries/L0');subplot(2,2,4); plot(t,Lce,'b'); axis([0 5 0 1]); xlabel('Time (sec)'); ylabel('Lcontractile/L0');figure(2)plot(t,H,'r');axis([0 5 0 50]); xlabel('Time (sec)'); ylabel('Heat/Length');% EXAMPLE 2 - STEP LENGTH CHANGEL = [repmat(1,400,1);repmat(0.95,600,1)];t = [linspace(0,5,1000)'];[P,H,Lse,Lce] = hill(L,t);figure(1)subplot(2,2,1); plot(t,L,'k'); axis([0 5 0 2]); xlabel('Time (sec)'); ylabel('Length/L0');subplot(2,2,2); plot(t,P,'r'); axis([0 5 0 200]); xlabel('Time (sec)'); ylabel('Force (mN/mm2)');subplot(2,2,3); plot(t,Lse,'g'); axis([0 5 0 1]);xlabel('Time (sec)'); ylabel('Lseries/L0');subplot(2,2,4); plot(t,Lce,'b'); axis([0 5 0 1]); xlabel('Time (sec)'); ylabel('Lcontractile/L0');figure(2)plot(t,H,'r');axis([0 5 0 50]); xlabel('Time (sec)'); ylabel('Heat/Length');% EXAMPLE 3 - CONSTANT VELOCITY SHORTENINGL = [repmat(1,600,1);linspace(1,0.4,400)'];t = [linspace(0,5,1000)'];[P,H,Lse,Lce] = hill(L,t);figure(1)subplot(2,2,1); plot(t,L,'k'); axis([0 5 0 2]); xlabel('Time (sec)'); ylabel('Length/L0');subplot(2,2,2); plot(t,P,'r'); axis([0 5 0 200]); xlabel('Time (sec)'); ylabel('Force (mN/mm2)');subplot(2,2,3); plot(t,Lse,'g'); axis([0 5 0 1]);xlabel('Time (sec)'); ylabel('Lseries/L0');subplot(2,2,4); plot(t,Lce,'b'); axis([0 5 0 1]); xlabel('Time (sec)'); ylabel('Lcontractile/L0');figure(2)hold on; plot(t,H,'r');axis([0 5 0 50]); xlabel('Time (sec)'); ylabel('Heat/Length');% EXAMPLE 4 - SHORTENING FIXED AMOUNT AT VARIOUS RATES% Vary the time over which shortening occurs (ts) from 100 to 600 and re-run this section%     of code at each new value.% The Figure 1 window will keep resetting but the Figure 2 (heat) window will add data from%     each new run to the existing plot.ts = 100;L = [repmat(1,400,1);linspace(1,0.5,ts)';repmat(0.5,(600-ts),1)];t = [linspace(0,5,1000)'];[P,H,Lse,Lce] = hill(L,t);figure(1)subplot(2,2,1); plot(t,L,'k'); axis([0 5 0 2]); xlabel('Time (sec)'); ylabel('Length/L0');subplot(2,2,2); plot(t,P,'r'); axis([0 5 0 200]); xlabel('Time (sec)'); ylabel('Force (mN/mm2)');subplot(2,2,3); plot(t,Lse,'g'); axis([0 5 0 1]);xlabel('Time (sec)'); ylabel('Lseries/L0');subplot(2,2,4); plot(t,Lce,'b'); axis([0 5 0 1]); xlabel('Time (sec)'); ylabel('Lcontractile/L0');figure(2)hold on; plot(t,H,'r');axis([0 5 0 50]); xlabel('Time (sec)'); ylabel('Heat/Length');% EXAMPLE 5 - SHORTENING VARIOUS AMOUNTS AT FIXED RATE% Vary the final length (Lf) from 0.9 to 0.4 and re-run this section%     of code at each new value.% The Figure 1 window will keep resetting but the Figure 2 (heat) window will add data from%     each new run to the existing plot.Lf = 0.4;ts = fix((1-Lf)*1000);L = [repmat(1,400,1);linspace(1,Lf,ts)';repmat(Lf,(600-ts),1)];t = [linspace(0,5,1000)'];[P,H,Lse,Lce] = hill(L,t);figure(1)subplot(2,2,1); plot(t,L,'k'); axis([0 5 0 2]); xlabel('Time (sec)'); ylabel('Length/L0');subplot(2,2,2); plot(t,P,'r'); axis([0 5 0 200]); xlabel('Time (sec)'); ylabel('Force (mN/mm2)');subplot(2,2,3); plot(t,Lse,'g'); axis([0 5 0 1]);xlabel('Time (sec)'); ylabel('Lseries/L0');subplot(2,2,4); plot(t,Lce,'b'); axis([0 5 0 1]); xlabel('Time (sec)'); ylabel('Lcontractile/L0');figure(2)hold on; plot(t,H,'r');axis([0 5 0 50]); xlabel('Time (sec)'); ylabel('Heat/Length');